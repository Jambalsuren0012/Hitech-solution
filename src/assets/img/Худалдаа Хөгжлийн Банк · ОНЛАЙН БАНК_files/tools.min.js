function gup(t,e){e||(e=location.href),t=t.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var n=new RegExp("[\\?&]"+t+"=([^&#]*)").exec(e);return null==n?null:n[1]}function createCookie(t,e,n){if(n){var a=new Date;a.setTime(a.getTime()+24*n*60*60*1e3);var i="; expires="+a.toGMTString()}else i="";document.cookie=t+"="+e+i+"; path=/; "}function getCookie(t){for(var e=t+"=",n=document.cookie.split(";"),a=0;a<n.length;a++){for(var i=n[a];" "==i.charAt(0);)i=i.substring(1,i.length);if(0==i.indexOf(e))return i.substring(e.length,i.length)}return null}function eraseCookie(t){createCookie(t,"",-1)}function generate_token(t){for(var e="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890".split(""),n=[],a=0;a<t;a++){var i=(Math.random()*(e.length-1)).toFixed(0);n[a]=e[i]}return n.join("")}function currencySymbol(t){var e={MNT:"₮",USD:"$",EUR:"€",CNY:"Ұ",JPY:"¥",AUD:"$",CAD:"$",GBP:"£",CHF:"Fr",RUB:"₽",KRW:"₩",SGD:"$",NZD:"$",HKD:"$",SEK:"kr"};return e[t]?e[t]:""}function maskAccountName(t){for(var e="",n=t.split(" "),a=0;n.length>a;){var i=n[a],l="",o=0;if(a>0)for(;i.length>o;)l+=i.charAt(o),o+1<i.length&&(l+="*"),o+2<i.length&&(l+="*"),o+=3;else l=i;e+=l+=" ",a++}return e}function mask2CharsText(t){for(var e="",n=t.split(" "),a=0;n.length>a;){for(var i=n[a],l="",o=0;i.length>o;)l+=i.charAt(o),o+1<i.length&&(l+=i.charAt(o+1)),o+2<i.length&&(l+="*"),o+=3;e+=l+=" ",a++}return e}function maskSensitiveText(t){for(var e="",n=t.split(" "),a=0;n.length>a;){for(var i=n[a],l="",o=0;i.length>o;)l+=i.charAt(o),o+1<i.length&&(l+="*"),o+2<i.length&&(l+="*"),o+=3;e+=l+=" ",a++}return e}function valid4chars(t){var e=t.split(""),n=/^[a-zA-Zа-яА-Я0-9/@\-';]+$/,a=0;for(i=0;i<e.length;i++)n.test(e[i])&&a++;return a}function getSecretPass(){return $("#ecode").val()}$((function(){var t,e=15;function n(){t=setTimeout((function(){--e>0?($("#qrcode-countdown").text(e),n(),l()):(UIkit.modal("#modal-qr-login").hide(),i())}),1e3)}function a(n){t=setTimeout((function(){--e>0?($("#qrcode-countdown").text(e),a(n),o(n)):(UIkit.modal("#modal-qr-login-off").hide(),i())}),1e3)}function i(){clearTimeout(t)}function l(){apiCallNoSense(api_callservice_url,{call:"check_qr_login_done",data:JSON.stringify({locale:_locale})},(function(t){1===t.success&&apiCall(api_callservice_url,{call:"qr_logout",data:JSON.stringify({locale:_locale})},(function(t){location.href=_login_url}),(function(t){}))}),(function(t){}))}function o(t){if(""==t)return!1;apiCallNoSense(api_callservice_url,{call:"validate_qr_token",data:JSON.stringify({locale:_locale,token:t})},(function(e){if(1==e.success){i();var n=e.result.loginid,a=getCookie($.base64.encode(n.toLowerCase()));$("#username").val(n),apiCallNoSense(api_callservice_url,{call:"qr_login",data:JSON.stringify({locale:_locale,token:t}),device_id:a},(function(t){1==t.success?(UIkit.modal("#modal-qr-login-off").hide(),i(),globalToken=t.token,1==t.result.require_signin_device?($("#masked-email").text(maskSensitiveText(t.result.retparams[19])),$("#masked-phone").text(maskSensitiveText(t.result.retparams[20])),UIkit.modal("#modal-signin-device",{modal:!1,keyboard:!1,bgclose:!1}).show().on({"hide.uk.modal":function(){loginCompleted||$("#uk-login-url").submit()}})):$("#uk-dashboard-url").submit()):($("#otpmobile").val(""),$("#vasco").val(""))}),(function(t){}))}else $("#otpmobile").val(""),$("#vasco").val("")}),(function(t){}))}if(UIkit.modal("#modal-qr-login").on({"hide.uk.modal":function(){i(),l()},"show.uk.modal":function(){e=15,$("#qrcode-countdown").text(e),$("#qrcode").html(""),apiCall(api_callservice_url,{call:"qr_login_generate",data:JSON.stringify({locale:_locale})},(function(t){1===t.success?($("#qrcode").qrcode("tdbbank://qrlogin?token="+t.result.retdata),n()):UIkit.modal.alert(t.message)}),(function(t){}))}}),UIkit.modal("#modal-qr-login-off").on({"hide.uk.modal":function(){i(),o("")},"show.uk.modal":function(){e=15,$("#qrcode-countdown").text(e),$("#qrcode2").html(""),apiCall(api_callservice_url,{call:"qr_login_generate_off",data:JSON.stringify({locale:_locale})},(function(t){1===t.success?($("#qrcode2").qrcode(t.result.retdata),a(t.result.retdata)):UIkit.modal.alert(t.message)}),(function(t){}))}}),"undefined"!=typeof _logouttimer){!function t(){setTimeout((function(){_logouttimer--,_logouttimer<=0&&_logouttimer>-2&&$(".logout").trigger("click");var e=Math.floor(_logouttimer/60);e=e<10?"0"+e:e;var n=_logouttimer-60*Math.floor(_logouttimer/60),a=e+":"+(n=n<10?"0"+n:n);$("#hdr-timer").text(a),t()}),1e3)}()}$(".btn-connection-refresh").click((function(t){apiCall(api_callservice_url,{token:$("#gtoken").val(),call:"general_params_renew_date",data:JSON.stringify({locale:"mn"})},(function(t){}),(function(t){}))}))})),jQuery.extend(jQuery.validator.messages,{required:"Заавал оруулах талбар",remote:"Please fix this field.",email:"И-мэйл хаягаа шалгана уу.",url:"Please enter a valid URL.",date:"Please enter a valid date.",dateISO:"Please enter a valid date (ISO).",number:"Тоо оруулна уу.",digits:"Зөвхөн тоо оруулна уу.",creditcard:"Please enter a valid credit card number.",equalTo:"Өмнөх утгаа дахин оруулна уу.",accept:"Please enter a value with a valid extension.",maxlength:jQuery.validator.format("Please enter no more than {0} characters."),minlength:jQuery.validator.format("Please enter at least {0} characters."),rangelength:jQuery.validator.format("Please enter a value between {0} and {1} characters long."),range:jQuery.validator.format("Please enter a value between {0} and {1}."),max:jQuery.validator.format("Please enter a value less than or equal to {0}."),min:jQuery.validator.format("Please enter a value greater than or equal to {0}.")});var CryptoJSAesJson={stringify:function(t){var e={ct:t.ciphertext.toString(CryptoJS.enc.Base64)};return t.iv&&(e.iv=t.iv.toString()),t.salt&&(e.s=t.salt.toString()),JSON.stringify(e)},parse:function(t){var e=JSON.parse(t),n=CryptoJS.lib.CipherParams.create({ciphertext:CryptoJS.enc.Base64.parse(e.ct)});return e.iv&&(n.iv=CryptoJS.enc.Hex.parse(e.iv)),e.s&&(n.salt=CryptoJS.enc.Hex.parse(e.s)),n}};function apiCall(t,e,n,a){_logouttimer=_logouttimer_default,loadingShow(),$("body").css("cursor","progress");var i=$("#gtoken").val(),l="";e.device_id&&(l=e.device_id),e.token=null,e.device_id=null;var o=!1;1==e.html_result&&(o=!0),$("#ftoken").length&&(e.ftoken=$("#ftoken").val()),postdata=CryptoJS.AES.encrypt(JSON.stringify(e),getSecretPass(),{format:CryptoJSAesJson}).toString(),$.ajax({type:"POST",url:t,data:postdata,crossDomain:!0,headers:{Indentify:i,"Device-Id":l,"Device-Type":"3","App-Version":$("#_app_version").val(),"Push-RegisterId":"dwFh0vnDd-8:APA91bEUvUUEdGxIeDCNYfGk7dIEXX0bpIZjFePYr2CKIKL382_dvO8yO3qjNN5UcgHSfIlQtzELdCxuUdk1WyGHLLMWDEWawR0JaNhqJWjosQIi9fqVwR2NkrYkI3Ejq-OknqQNZhFr1234"},xhrFields:{withCredentials:!0},success:function(t){if(o||(t=CryptoJS.AES.decrypt(t,getSecretPass(),{format:CryptoJSAesJson}).toString(CryptoJS.enc.Utf8),(t=JSON.parse(t)).token&&$("#gtoken").val(t.token),void 0!==t.result.ntoken&&($("#ftoken").length>0&&t.result.ntoken&&$("#ftoken").val(t.result.ntoken),$("#_csrf").length>0&&t.result.ntoken&&$("#_csrf").val(t.result.ntoken))),601===t.code||701===t.code)return UIkit.modal.alert(t.message),$("#uk-login-url").submit(),!1;$("body").css("cursor","default"),loadingHide(),n(t)},error:function(t){$("body").css("cursor","default"),loadingHide(),a(t)}})}function apiCallNoSense(t,e,n,a){_logouttimer=_logouttimer_default;var i=$("#gtoken").val(),l="";e.device_id&&(l=e.device_id),e.token=null,e.device_id=null;var o=!1;1==e.html_result&&(o=!0),$("#ftoken").length&&(e.ftoken=$("#ftoken").val()),postdata=CryptoJS.AES.encrypt(JSON.stringify(e),getSecretPass(),{format:CryptoJSAesJson}).toString(),$.ajax({type:"POST",url:t,data:postdata,crossDomain:!0,headers:{Indentify:i,"Device-Id":l,"Device-Type":"3","App-Version":$("#_app_version").val(),"Push-RegisterId":"dwFh0vnDd-8:APA91bEUvUUEdGxIeDCNYfGk7dIEXX0bpIZjFePYr2CKIKL382_dvO8yO3qjNN5UcgHSfIlQtzELdCxuUdk1WyGHLLMWDEWawR0JaNhqJWjosQIi9fqVwR2NkrYkI3Ejq-OknqQNZhFr1234"},xhrFields:{withCredentials:!0},success:function(t){if(o||(t=CryptoJS.AES.decrypt(t,getSecretPass(),{format:CryptoJSAesJson}).toString(CryptoJS.enc.Utf8),(t=JSON.parse(t)).token&&$("#gtoken").val(t.token),void 0!==t.result.ntoken&&($("#ftoken").length>0&&t.result.ntoken&&$("#ftoken").val(t.result.ntoken),$("#_csrf").length>0&&t.result.ntoken&&$("#_csrf").val(t.result.ntoken))),601===t.code||701===t.code)return UIkit.modal.alert(t.message),$("#uk-login-url").submit(),!1;n(t)},error:function(t){a(t)}})}function apiCallNoWait(t,e,n){_logouttimer=_logouttimer_default;var a=$("#gtoken").val(),i="";e.device_id&&(i=e.device_id),e.token=null,e.device_id=null;e.html_result,$("#ftoken").length&&(e.ftoken=$("#ftoken").val()),postdata=CryptoJS.AES.encrypt(JSON.stringify(e),getSecretPass(),{format:CryptoJSAesJson}).toString(),$.ajax({type:"POST",url:t,data:postdata,crossDomain:!0,headers:{Indentify:a,"Device-Id":i,"Device-Type":"3","App-Version":$("#_app_version").val(),"Push-RegisterId":"dwFh0vnDd-8:APA91bEUvUUEdGxIeDCNYfGk7dIEXX0bpIZjFePYr2CKIKL382_dvO8yO3qjNN5UcgHSfIlQtzELdCxuUdk1WyGHLLMWDEWawR0JaNhqJWjosQIi9fqVwR2NkrYkI3Ejq-OknqQNZhFr1234"},xhrFields:{withCredentials:!0},timeout:n})}function loadingShow(){$("#loadingModal").show()}function loadingHide(){$("#loadingModal").hide()}function checkJsonString(t){return t=t.toString(),!!/^[\],:{}\s]*$/.test(t.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))}function passwordConfirm(t,e,n){$("#txnpasswordlabel").text(t),UIkit.modal("#modal-txn-password").show(),$("#txnpassword").val(""),$(".uk-modal-close").click((function(t){n()}));$("#frm-txn-password").validate({rules:{},messages:{},errorElement:"em",errorPlacement:function(t,e){t.addClass("invalid-feedback"),"checkbox"===e.prop("type")?t.insertAfter(e.parent("label")):t.insertAfter(e)},highlight:function(t,e,n){$(t).addClass("is-invalid").removeClass("is-valid")},unhighlight:function(t,e,n){$(t).addClass("is-valid").removeClass("is-invalid")},submitHandler:function(t){UIkit.modal("#modal-txn-password").hide();var n=$("#txnpassword").val();return e(n),!1}})}function password1Confirm(t,e,n){$("#txnpasswordlabel").text(t),UIkit.modal("#modal-txn-password").show(),$("#txnpassword").val(""),$(".uk-modal-close").click((function(t){n()})),$("#frm-txn-password").validate({rules:{},messages:{},errorElement:"em",errorPlacement:function(t,e){t.addClass("invalid-feedback"),"checkbox"===e.prop("type")?t.insertAfter(e.parent("label")):t.insertAfter(e)},highlight:function(t,e,n){$(t).addClass("is-invalid").removeClass("is-valid")},unhighlight:function(t,e,n){$(t).addClass("is-valid").removeClass("is-invalid")},submitHandler:function(t){UIkit.modal("#modal-txn-password").hide();var n=$("#txnpassword").val();return e(n),!1}})}function password2Confirm(t,e,n){$("#txnpasswordlabel2").text(t),UIkit.modal("#modal-txn-password2").show(),$("#txnpassword2").val(""),$(".uk-modal-close").click((function(t){n()})),$("#frm-txn-password2").validate({rules:{},messages:{},errorElement:"em",errorPlacement:function(t,e){t.addClass("invalid-feedback"),"checkbox"===e.prop("type")?t.insertAfter(e.parent("label")):t.insertAfter(e)},highlight:function(t,e,n){$(t).addClass("is-invalid").removeClass("is-valid")},unhighlight:function(t,e,n){$(t).addClass("is-valid").removeClass("is-invalid")},submitHandler:function(t){UIkit.modal("#modal-txn-password2").hide();var n=$("#txnpassword2").val();return e(n),!1}})}function password3Confirm(t,e,n){$("#txnpasswordlabel3").text(t),UIkit.modal("#modal-txn-password3").show(),$("#txnpassword3").val(""),$(".uk-modal-close").click((function(t){n()})),$("#frm-txn-password3").validate({rules:{},messages:{},errorElement:"em",errorPlacement:function(t,e){t.addClass("invalid-feedback"),"checkbox"===e.prop("type")?t.insertAfter(e.parent("label")):t.insertAfter(e)},highlight:function(t,e,n){$(t).addClass("is-invalid").removeClass("is-valid")},unhighlight:function(t,e,n){$(t).addClass("is-valid").removeClass("is-invalid")},submitHandler:function(t){UIkit.modal("#modal-txn-password3").hide();var n=$("#txnpassword3").val();return e(n),!1}})}function password4Confirm(t,e,n){$("#txnpasswordlabel4").text(t),UIkit.modal("#modal-txn-password4").show(),$("#txnpassword4").val(""),$(".uk-modal-close").click((function(t){n()})),$("#frm-txn-password4").validate({rules:{},messages:{},errorElement:"em",errorPlacement:function(t,e){t.addClass("invalid-feedback"),"checkbox"===e.prop("type")?t.insertAfter(e.parent("label")):t.insertAfter(e)},highlight:function(t,e,n){$(t).addClass("is-invalid").removeClass("is-valid")},unhighlight:function(t,e,n){$(t).addClass("is-valid").removeClass("is-invalid")},submitHandler:function(t){UIkit.modal("#modal-txn-password4").hide();var n=$("#txnpassword4").val();return e(n),!1}})}function password5Confirm(t,e,n){$("#txnpasswordlabel5").text(t),UIkit.modal("#modal-txn-password5").show(),$("#txnpassword5").val(""),$(".uk-modal-close").click((function(t){n()})),$("#frm-txn-password5").validate({rules:{},messages:{},errorElement:"em",errorPlacement:function(t,e){t.addClass("invalid-feedback"),"checkbox"===e.prop("type")?t.insertAfter(e.parent("label")):t.insertAfter(e)},highlight:function(t,e,n){$(t).addClass("is-invalid").removeClass("is-valid")},unhighlight:function(t,e,n){$(t).addClass("is-valid").removeClass("is-invalid")},submitHandler:function(t){UIkit.modal("#modal-txn-password5").hide();var n=$("#txnpassword5").val();return e(n),!1}})}function password6Confirm(t,e,n){$("#txnpasswordlabel6").text(t),UIkit.modal("#modal-txn-password6").show(),$("#txnpassword6").val(""),$(".uk-modal-close").click((function(t){n()})),$("#frm-txn-password6").validate({rules:{},messages:{},errorElement:"em",errorPlacement:function(t,e){t.addClass("invalid-feedback"),"checkbox"===e.prop("type")?t.insertAfter(e.parent("label")):t.insertAfter(e)},highlight:function(t,e,n){$(t).addClass("is-invalid").removeClass("is-valid")},unhighlight:function(t,e,n){$(t).addClass("is-valid").removeClass("is-invalid")},submitHandler:function(t){UIkit.modal("#modal-txn-password6").hide();var n=$("#txnpassword6").val();return e(n),!1}})}function password7Confirm(t,e,n){$("#txnpasswordlabel7").text(t),UIkit.modal("#modal-txn-password7").show(),$("#txnpassword7").val(""),$(".uk-modal-close").click((function(t){n()})),$("#frm-txn-password7").validate({rules:{},messages:{},errorElement:"em",errorPlacement:function(t,e){t.addClass("invalid-feedback"),"checkbox"===e.prop("type")?t.insertAfter(e.parent("label")):t.insertAfter(e)},highlight:function(t,e,n){$(t).addClass("is-invalid").removeClass("is-valid")},unhighlight:function(t,e,n){$(t).addClass("is-valid").removeClass("is-invalid")},submitHandler:function(t){UIkit.modal("#modal-txn-password7").hide();var n=$("#txnpassword7").val();return e(n),!1}})}function password8Confirm(t,e,n){$("#txnpasswordlabel8").text(t),UIkit.modal("#modal-txn-password8").show(),$("#txnpassword8").val(""),$(".uk-modal-close").click((function(t){n()})),$("#frm-txn-password8").validate({rules:{},messages:{},errorElement:"em",errorPlacement:function(t,e){t.addClass("invalid-feedback"),"checkbox"===e.prop("type")?t.insertAfter(e.parent("label")):t.insertAfter(e)},highlight:function(t,e,n){$(t).addClass("is-invalid").removeClass("is-valid")},unhighlight:function(t,e,n){$(t).addClass("is-valid").removeClass("is-invalid")},submitHandler:function(t){UIkit.modal("#modal-txn-password8").hide();var n=$("#txnpassword8").val();return e(n),!1}})}function password9Confirm(t,e,n){$("#txnpasswordlabel9").text(t),UIkit.modal("#modal-txn-password9").show(),$("#txnpassword9").val(""),$(".uk-modal-close").click((function(t){n()})),$("#frm-txn-password9").validate({rules:{},messages:{},errorElement:"em",errorPlacement:function(t,e){t.addClass("invalid-feedback"),"checkbox"===e.prop("type")?t.insertAfter(e.parent("label")):t.insertAfter(e)},highlight:function(t,e,n){$(t).addClass("is-invalid").removeClass("is-valid")},unhighlight:function(t,e,n){$(t).addClass("is-valid").removeClass("is-invalid")},submitHandler:function(t){UIkit.modal("#modal-txn-password9").hide();var n=$("#txnpassword9").val();return e(n),!1}})}function tanConfirm(t,e,n){for(var a="",i=0;t.length>i;){var l=t[i];"label"==l.fieldtype?a+='<div class="text-dark text-medium uk-text-uppercase text-12 margin-top-20">'+l.label+":</div>":"input"==l.fieldtype&&(a+=(l.label?'<div class="uk-margin-small-bottom text-13 margin-top-10" id="lbl'+l.fieldid+'"> '+l.label+":</div>":"")+'<input type="text" name="tan'+l.fieldid+'" id="tan'+l.fieldid+'" data-fieldid="'+l.fieldid+'" value="" class="gray-blue uk-width-1-1 uk-width-medium-5-5 tan_mfield" style="font-size: 14px!important" required>'),i++}$("#tan-fields").html(a),UIkit.modal("#modal-loan-tan").show(),$(".uk-modal-close").click((function(t){n()})),$("#frm-ln-tan").validate({rules:{},messages:{},errorElement:"em",errorPlacement:function(t,e){t.addClass("invalid-feedback"),"checkbox"===e.prop("type")?t.insertAfter(e.parent("label")):t.insertAfter(e)},highlight:function(t,e,n){$(t).addClass("is-invalid").removeClass("is-valid")},unhighlight:function(t,e,n){$(t).addClass("is-valid").removeClass("is-invalid")},submitHandler:function(t){var n={locale:_locale};return $(".tan_mfield").each((function(t){var e=$(this).data("fieldid"),a=$(this).val();n[e]=a.replace(/,/g,"")})),UIkit.modal("#modal-loan-tan").hide(),e(n),!1}})}function cardStatusText(t){return{"Not active":"mn"==_locale?"Идэвхигүй":"Not active",Opened:"mn"==_locale?"Нээлттэй":"Opened",Lost:"mn"==_locale?"Гээсэн":"Lost",Stolen:"mn"==_locale?"Хулгайд алдсан":"Stolen",Closed:"mn"==_locale?"Хаалттай":"Closed",Referral:(_locale,"Referral"),Declared:"mn"==_locale?"Шинэ":"Declared",Expired:"mn"==_locale?"Хугацаа дууссан":"Expired",New:"mn"==_locale?"Шинэ":"New"}[t]}function cardStatusTextByStatus(t){var e="mn"==_locale?"Идэвхигүй":"Not active";switch(t){case"0":default:e="mn"==_locale?"Идэвхигүй":"Not active";break;case"1":e="mn"==_locale?"Нээлттэй":"Opened";break;case"2":e="mn"==_locale?"Гээсэн":"Lost";break;case"3":e="mn"==_locale?"Хулгайд алдсан":"Stolen";break;case"9":e="mn"==_locale?"Хаалттай":"Closed";break;case"A":_locale,e="Referral";break;case"C":e="mn"==_locale?"Шинэ":"Declared";break;case"C3":e="mn"==_locale?"Шинэ":"New";break;case"F":e="mn"==_locale?"Хугацаа дууссан":"Expired"}return e}var statuses=[{value:-1,title:"mn"==_locale?"Бүгд":"All"},{value:0,title:"mn"==_locale?"Шинэ":"New"},{value:1,title:"mn"==_locale?"Зөвшөөрсөн":"Approved"},{value:2,title:"mn"==_locale?"Гүйлгээ хийгдсэн":"Transaction made"},{value:9,title:"mn"==_locale?"Цуцлагдсан":"Canceled"}],txncodes=[{value:91047,title:"Өөрийн данс хооронд шилжүүлэг"},{value:91045,title:"Банк доторх шилжүүлэг"},{value:91046,title:"Банк хоорондын шилжүүлэх"},{value:91016,title:"Гадаад банк руу шилжүүлэг хийх"}];function getStatus(t){for(var e="",n=0;statuses.length>n;)t==statuses[n].title&&(e=statuses[n].value),n++;return e}function getStatusTitle(t){for(var e="",n=0;statuses.length>n;)t==statuses[n].value&&(e=statuses[n].title),n++;return e}function getTxnTitle(t){for(var e="",n=0;txncodes.length>n;)t==txncodes[n].value&&(e=txncodes[n].title),n++;return e}var ulaanbaatarCityCode="11",selectedDist="0",selectedAimag="0",typeBranch="0",typeAtm="1",allDists=[],aimagsLoaded=!1,ubLoaded=!1;function imageExists(t,e){var n=new Image;n.onload=function(){e(!0)},n.onerror=function(){e(!1)},n.src=t}function isInArray(t,e){return t.indexOf(e)>=0}function setBranches(t,e,n){"mn"===e?$(t).find("DETAIL")[0].textContent:$(t).find("DETAIL2")[0].textContent;var a=0;if(null==$(t).find("WHAT3WORD_MN")[0])var i=0,l=0;else i=$(t).find("WHAT3WORD_MN")[0].textContent,l=$(t).find("WHAT3WORD_EN")[0].textContent;0==i&&0==l||(a="mn"===e?i:l);var o="mn"===e?"Имэйл":"Email",s="mn"===e?"Утас":"Phone",r="mn"===e?"3 үгт хаяг":"what3words",d="mn"===e?"Цагийн хуваарь":"Time table",c=$(t).find("ID")[0].textContent,u="http://www.tdbm.mn/bundles/public/uploads/branches/"+c+".jpg";imageExists(u,(function(t){t||$("#id-"+c).attr("src","/bundles/web/xml/branch.png")})),"en"==e&&($(t).find("PHONE")[0].textContent=$(t).find("PHONE")[0].textContent.replace("Мэдээллийн ажилтан","Information Officer"),$(t).find("PHONE")[0].textContent=$(t).find("PHONE")[0].textContent.replace("Зээлийн мэргэжилтэн","Loan Officer"),$(t).find("PHONE")[0].textContent=$(t).find("PHONE")[0].textContent.replace("Зээлийн ажилтан","Loan Officer"),$(t).find("PHONE")[0].textContent=$(t).find("PHONE")[0].textContent.replace("Удахгүй шинэчлэгдэнэ","Will be updated soon"),$(t).find("PHONE")[0].textContent=$(t).find("PHONE")[0].textContent.replace("Факс","Fax"));var f='<div class="branch-thumbnail uk-width-1-2 uk-float-left margin-bottom-20" id="branch-'+c+'"> <div class="uk-grid uk-grid-medium"><div class="uk-width-1-1 uk-width-small-1-2 uk-row-first"><div class="branch-thumb-left uk-grid"> <div class="branch-thumb-left-name uk-text-uppercase text-dark text-medium">'+("mn"===e?$(t).find("TITLE")[0].textContent:$(t).find("TITLE2")[0].textContent)+'</div> <div class="branch-thumb-left-img"><img id="id-'+c+'" src="'+u+'" /></div></div></div><div class="uk-width-1-1 uk-width-small-1-2" style="padding:0 20px 0 0;"><div class="branch-thumb-right margin-top-30"><div class="branch-address-top">'+("mn"===e?$(t).find("ADDR")[0].textContent:$(t).find("ADDR2")[0].textContent)+'</div><table class="branch-info-table"><tr><th style="text-align: right; width:18px"> <img src="/bundles/web/xml/btelephone.png" style="width: 16px" title="'+s+'"/></th><td>'+$(t).find("PHONE")[0].textContent+'</td></tr><tr><th style="text-align: right"><img src="/bundles/web/xml/bmail.png" style="width: 16px" title="'+o+'" /></th><td style="padding-top:2px;"><a  href="mailto:'+$(t).find("EMAIL")[0].textContent+'">'+$(t).find("EMAIL")[0].textContent+"</a></td></tr>"+(0!=a?'<tr><th style="text-align: right"><img src="/bundles/web/xml/w3word.png" style="width: 16px" title="'+r+'"/></th><td style="padding-top:2px;"><a href="https://w3w.co/'+a+'" target="_blank">'+a+"</a></td></tr>":"")+'</table><div class="branch-address-bottom"><div class="time-code-title">'+d+':</div><div class="time-table" data-timecode="'+$(t).find("TIMECODE")[0].textContent+'" ></div></div></div></div></div></div>';$(n).append(f)}function setTimeCodes(t){$(".time-table").each((function(){var e=$(this).data("timecode"),n=this;""===$(this).html()&&$.ajax({type:"GET",url:"/bundles/web/xml/TimeCodes.xml",dataType:"xml",success:function(a){$(a).find("TIMECODE").each((function(){if(void 0!==$(this).find("TIMECODE")[0]){var a=$(this).find("TIMECODE")[0].textContent;if(e==a){for(var i=[$(this).find("DAY1START")[0].textContent+"-"+$(this).find("DAY1END")[0].textContent,$(this).find("DAY2START")[0].textContent+"-"+$(this).find("DAY2END")[0].textContent,$(this).find("DAY3START")[0].textContent+"-"+$(this).find("DAY3END")[0].textContent,$(this).find("DAY4START")[0].textContent+"-"+$(this).find("DAY4END")[0].textContent,$(this).find("DAY5START")[0].textContent+"-"+$(this).find("DAY5END")[0].textContent,$(this).find("DAY6START")[0].textContent+"-"+$(this).find("DAY6END")[0].textContent,$(this).find("DAY7START")[0].textContent+"-"+$(this).find("DAY7END")[0].textContent],l=["Дав","Мяг","Лха","Пүр","Баа","Бям","Ням"],o=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],s="",r=0,d=1;d<=i.length;d++)if(i[d-1]!==i[d]){var c="mn"===t?l:o;s+=(c[r]===c[d-1]?c[r]:c[r]+"-"+c[d-1])+": "+i[r]+"<br/>",r=d}var u="mn"===t?"Амарна":"Closed";s=s.replace(/00:00-00:00/g,u),$(n).html(s)}}}))}})}))}function loadSaturdayBranches(t,e){$(e).html(""),$.ajax({type:"GET",url:"/bundles/web/xml/Weekend.xml",dataType:"xml",success:function(n){$(n).find("BRANCH").each((function(){var n=$(this).find("TYPE")[0].textContent,a=$(this).find("D6")[0].textContent;n==typeBranch&&"1"!=a&&setBranches(this,t,e)})),setTimeCodes(t)}})}function loadSundayBranches(t,e){$(e).html(""),$.ajax({type:"GET",url:"/bundles/web/xml/Weekend.xml",dataType:"xml",success:function(n){$(n).find("BRANCH").each((function(){var n=$(this).find("TYPE")[0].textContent,a=$(this).find("D7")[0].textContent;n==typeBranch&&"1"!=a&&setBranches(this,t,e)})),setTimeCodes(t)}})}function loadUbDists(t,e){if(ubLoaded)return!0;$("#tab-ulaanbaatar").html(""),$("#ulaanbaatar-tabs").html("");var n=[];$.ajax({type:"GET",url:"/bundles/web/xml/Locations.xml",dataType:"xml",success:function(e){$(e).find("BRANCH").each((function(){var t=$(this).find("DISTCODE")[0].textContent;0!=n.length&&isInArray(n,t)||n.push(t)})),$.ajax({type:"GET",url:"/bundles/web/xml/Dists.xml",dataType:"xml",success:function(e){var a=1;allDists=[],$(e).find("DIST").each((function(){var e=$(this).find("CITYCODE")[0].textContent,i=$(this).find("DISTCODE")[0].textContent;if(isInArray(n,i)&&e==ulaanbaatarCityCode){var l="";1===a&&(selectedDist=$(this).find("DISTCODE")[0].textContent,l="uk-active");var o="mn"===t?$(this).find("NAME")[0].textContent:$(this).find("NAME2")[0].textContent,s='<li class="item branch-district '+l+'" data-code="'+$(this).find("DISTCODE")[0].textContent+'" data-tab="'+a+'" ><a type="button">'+o+"</a></li>";$("#tab-ulaanbaatar").append(s),$("#ulaanbaatar-tabs").append('<li id="ulaanbaatar-tab'+a+'" style="max-height: 400px; overflow-y: auto"></li>'),loadUbBranches(t,"#ulaanbaatar-tab"+a,$(this).find("DISTCODE")[0].textContent),a++}allDists.push({cityCode:e,distCode:i,name:$(this).find("NAME")[0].textContent,nameEn:$(this).find("NAME2")[0].textContent})})),$(".branch-district").first().trigger("click")}})}}),ubLoaded=!0}function loadUbBranches(t,e,n){$(".branch-thumbnails").html(""),$.ajax({type:"GET",url:"/bundles/web/xml/Locations.xml",dataType:"xml",success:function(a){$(a).find("BRANCH").each((function(){var a=$(this).find("CITYCODE")[0].textContent,i=$(this).find("TYPE")[0].textContent,l=$(this).find("DISTCODE")[0].textContent;a==ulaanbaatarCityCode&&i==typeBranch&&n==l&&setBranches(this,t,e)})),setTimeCodes(t)}})}function loadRuralBranches(t,e,n){$(".branch-thumbnails").html(""),$.ajax({type:"GET",url:"/bundles/web/xml/Locations.xml",dataType:"xml",success:function(a){$(a).find("BRANCH").each((function(){var a=$(this).find("CITYCODE")[0].textContent,i=$(this).find("TYPE")[0].textContent;$(this).find("DISTCODE")[0].textContent;a==n&&i==typeBranch&&setBranches(this,t,e)})),setTimeCodes(t)}})}function loadAimags(t,e){if(aimagsLoaded)return!0;$("#tab-localarea").html(""),$("#localarea-tabs").html("");$.ajax({type:"GET",url:"/bundles/web/xml/Cities.xml",dataType:"xml",success:function(e){$(e).find("CITY").each((function(){var e=$(this).find("CITYCODE")[0].textContent,n=this;$.ajax({type:"GET",url:"/bundles/web/xml/Locations.xml",dataType:"xml",beforeSend:function(t){0},success:function(a){0;var i=!1;if($(a).find("BRANCH").each((function(){var t=$(this).find("CITYCODE")[0].textContent;if(e===t)return i=!0,!1})),i&&e!==ulaanbaatarCityCode){var l="";selectedAimag===e&&(l="uk-active");var o="mn"===t?$(n).find("NAME")[0].textContent:$(n).find("NAME2")[0].textContent,s='<li class="item branch-aimag aimag '+l+'" data-code="'+e+'" data-tab="'+e+'" ><a type="button">'+o+"</a></li>";$("#tab-localarea").append(s),$("#localarea-tabs").append('<li id="localarea-tab'+e+'" style="max-height: 400px; overflow-y: auto"></li>'),loadRuralBranches(t,"#localarea-tab"+e,e)}$(".branch-aimag").first().trigger("click")}})}))}}),aimagsLoaded=!0}function loadGoogleMap(t,e,n){var a=parseInt($("#map-zoom").val()),i=$("#map-type").val(),l=new google.maps.LatLngBounds,o=new google.maps.Map(document.getElementById("map"),{zoom:a});o.setMapTypeId(i),google.maps.event.addListener(o,"zoom_changed",(function(){var t=o.getZoom();$("#map-zoom").val(t)})),google.maps.event.addListener(o,"maptypeid_changed",(function(){var t=o.getMapTypeId();$("#map-type").val(t)})),google.maps.event.addListener(o,"center_changed",(function(){var t=o.getCenter();$("#map-last-lat").val(t.lat()),$("#map-last-lng").val(t.lng())}));var s,r=new google.maps.InfoWindow,d=[],c=0;$.ajax({type:"GET",url:"/bundles/web/xml/TimeCodes.xml",dataType:"xml",beforeSend:function(t){c++},success:function(a){c--,$(a).find("TIMECODE").each((function(){if(void 0!==$(this).find("TIMECODE")[0]){var t=$(this).find("TIMECODE")[0].textContent;d[t]=this}}));var i=0;$.ajax({type:"GET",url:"/bundles/web/xml/Locations.xml",dataType:"xml",beforeSend:function(t){i++},success:function(a){i--;var u=0;if($(a).find("BRANCH").each((function(){var a=$(this).find("CITYCODE")[0].textContent,i=$(this).find("TYPE")[0].textContent,c=$(this).find("DISTCODE")[0].textContent,f=$(this).find("ATMTYPE")[0].textContent,m=this;if((void 0===t||i==t||15==t)&&!(15==t&&1!=i&&5!=i||(void 0!==t&&(void 0===e&&"0"!=$("#map-nav-city-choice").val()&&(e=$("#map-nav-city-choice").val()),void 0===n&&"0"!=$("#map-nav-dist-choice").val()&&(n=$("#map-nav-dist-choice").val())),void 0!==e&&void 0!==n&&(e!=a||n!=c)||void 0!==e&&e!=a))){var p=$(m).find("TIMECODE")[0].textContent,v=!1;if(void 0!==d[p]){var h=d[p],g=new Date,x=g.getDay(),C=g.getHours(),b=g.getMinutes(),k=g.getFullYear(),w=g.getMonth()+1,y=g.getDate(),E=(x=0==x?"7":x,$(h).find("DAY"+x+"START")[0].textContent),T=$(h).find("DAY"+x+"END")[0].textContent;if("00:00"!=E&&"00:00"!=T){var _=E.split(":"),D=T.split(":"),A=new Date(k,w,y,_[0],_[1],"00","00"),I=new Date(k,w,y,D[0],D[1],"00","00"),S=new Date(k,w,y,C,b,"00","00"),N=A.getTime(),O=I.getTime(),P=S.getTime();P>N&&P<O&&(v=!0)}"mn"==lang?$(h).find("NAME")[0].textContent:$(h).find("NAME2")[0].textContent}0==i?markerType=v?"/bundles/web/xml/pin_50_orange.png":"/bundles/web/xml/pin_50-2015-02-05-195558-1134318323.png":1==i?markerType=v?2==f?"/bundles/web/xml/deposit_ATM_enabled.png":"/bundles/web/xml/pin_50_ATM_enable.png":2==f?"/bundles/web/xml/deposit_ATM_disabled.png":"/bundles/web/xml/pin_50_ATM_disable.png":3==i?markerType=v?"/bundles/web/xml/pin_Lady_open.png":"/bundles/web/xml/pin_Lady_closed.png":4==i?markerType=v?"/bundles/web/xml/pin_Britto_open.png":"/bundles/web/xml/pin_Britto_closed.png":5==i&&(markerType=v?"/bundles/web/xml/deposit_ATM_enabled.png":"/bundles/web/xml/deposit_ATM_disabled.png"),s=new google.maps.Marker({position:new google.maps.LatLng(parseFloat($(this).find("LAT")[0].textContent),parseFloat($(this).find("LNG")[0].textContent)),map:o,icon:markerType}),l.extend(s.getPosition()),"en"==lang&&($(m).find("PHONE")[0].textContent=$(m).find("PHONE")[0].textContent.replace("Мэдээллийн ажилтан","Information Officer"),$(m).find("PHONE")[0].textContent=$(m).find("PHONE")[0].textContent.replace("Зээлийн мэргэжилтэн","Loan Officer"),$(m).find("PHONE")[0].textContent=$(m).find("PHONE")[0].textContent.replace("Зээлийн ажилтан","Loan Officer"),$(m).find("PHONE")[0].textContent=$(m).find("PHONE")[0].textContent.replace("Удахгүй шинэчлэгдэнэ","Will be updated soon"),$(m).find("PHONE")[0].textContent=$(m).find("PHONE")[0].textContent.replace("Факс","Fax"));var H=0;if("undefined"==$(m).find("WHAT3WORD_MN")[0])var U=0,L=0;else U=$(m).find("WHAT3WORD_MN")[0].textContent,L=$(m).find("WHAT3WORD_EN")[0].textContent;0==U&&0==L||(H="mn"===lang?U:L);var M="mn"===lang?"3 үгт хаяг":"what3words";google.maps.event.addListener(s,"click",function(t,e){return function(){var e="<strong>"+("mn"===lang?$(m).find("TITLE")[0].textContent:$(m).find("TITLE2")[0].textContent)+"<strong><br>";e+="<div>"+("mn"===lang?$(m).find("ADDR")[0].textContent:$(m).find("ADDR2")[0].textContent)+"</div>",e+="<div>"+$(m).find("EMAIL")[0].textContent+"</div>",e+="<div>"+$(m).find("PHONE")[0].textContent+"</div>",e+=""!=H?"<div>"+M+': /// <a href="https://w3w.co/'+H+'" target="_blank">'+H+"</a></div>":"",r.setContent(e),r.open(o,t)}}(s)),u++}})),0==c&&0==i&&u>0)if("0"==$("#map-nav-city-choice").val())o.fitBounds(l),o.setCenter(l.getCenter()),o.setZoom(6);else{o.setCenter(l.getCenter());var f=$("#map-nav-city-choice").val()==ulaanbaatarCityCode?12:8;"0"!=$("#map-nav-dist-choice").val()&&(f=13),o.setZoom(f)}}})}})}function getDistAndSoumList(t){$("#map-nav-dist-choice option").each((function(){"0"!=$(this).attr("value")&&$(this).remove()}));for(var e=0;e<allDists.length;e++)if(allDists[e].cityCode==t){var n="mn"===lang?allDists[e].name:allDists[e].nameEn,a="<option value='"+allDists[e].distCode+"'>"+n+"</option>";$("#map-nav-dist-choice").append(a)}allDists.length<=0&&$.ajax({type:"GET",url:"/bundles/web/xml/Dists.xml",dataType:"xml",success:function(e){allDists=[],$(e).find("DIST").each((function(){var t=$(this).find("CITYCODE")[0].textContent,e=$(this).find("DISTCODE")[0].textContent;allDists.push({cityCode:t,distCode:e,name:$(this).find("NAME")[0].textContent,nameEn:$(this).find("NAME2")[0].textContent})}));for(var n=0;n<allDists.length;n++)if(allDists[n].cityCode==t){var a="mn"===lang?allDists[n].name:allDists[n].nameEn,i="<option value='"+allDists[n].distCode+"'>"+a+"</option>";$("#map-nav-dist-choice").append(i)}}})}